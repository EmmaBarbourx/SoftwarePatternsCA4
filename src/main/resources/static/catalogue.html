<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Book Catalogue</title>  
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--  Bootstrap 5 CDN  -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>

<body class="container py-4">

    <h1>Book Catalogue</h1> 
    
     <!-- search + sort bar -->
  <div class="mb-3">
    <input id="query" class="form-control d-inline w-50"
           placeholder="Search for a title, author, …">
    <select id="crit" class="form-select d-inline w-auto">
      <option value="title"     selected>Title</option>
      <option value="author">Author</option>
      <option value="publisher">Publisher</option>
      <option value="category">Category</option>
    </select>
    <button class="btn btn-primary" onclick="search()">Search</button>
  </div>

  <!-- results -->
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Title</th><th>Author</th><th>Publisher</th><th>Price</th>
      </tr>
    </thead>
    <tbody id="bookRows"></tbody>
  </table>

  <script src="app.js"></script>
  <script>
    async function search() {
      const crit = qs('#crit').value;
      const q    = qs('#query').value.trim();
      if (!q) return;

      try {
        const books = await api(`/api/books/search?criterion=${crit}&query=${encodeURIComponent(q)}`);
        render(books);
      } catch (err) {
        alert(err.message);
      }
    }

    function render(list) {
      byId('bookRows').innerHTML = list.map(b => `
        <tr onclick="location='book.html?id=${b.id}'" style="cursor:pointer">
          <td>${b.title}</td>
          <td>${b.author}</td>
          <td>${b.publisher}</td>
          <td>€${b.price}</td>
        </tr>
      `).join('');
    }
  </script>
</body>
</html>
